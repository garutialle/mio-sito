<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Toolbox ‚Äì Password, IP & Subnet</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --bg: #fff;
      --fg: #000;
      --primary: #007acc;
      --accent: #00c853;
      --input-bg: #f0f0f0;
      --border: #ccc;
    }
    [data-theme="dark"] {
      --bg: #1e1e1e;
      --fg: #f0f0f0;
      --primary: #007acc;
      --accent: #00c853;
      --input-bg: #333;
      --border: #555;
    }
    body {
      background: var(--bg);
      color: var(--fg);
      font-family: sans-serif;
      margin: 0;
      transition: all 0.3s ease;
    }
    nav, header, footer {
      text-align: center;
      padding: 1rem;
    }
    nav button {
      margin: 0.2rem;
      padding: 0.5rem 1rem;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    nav button.active {
      background: var(--accent);
    }
    section { display: none; padding: 2rem; text-align: center; }
    section.active { display: block; }
    input[type="text"], input[type="range"] {
      width: 80%;
      padding: 0.5rem;
      font-size: 1rem;
      margin-top: 1rem;
      border: 2px solid var(--border);
      border-radius: 5px;
      background: var(--input-bg);
      color: var(--fg);
    }
    .theme-toggle {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 1.5rem;
      background: none;
      border: none;
      color: var(--fg);
      cursor: pointer;
    }
  </style>
</head>
<body data-theme="light">
  <button class="theme-toggle" onclick="toggleTheme()">üåì</button>
  <header><h1>Toolbox ‚Äì Password, IP & Subnet</h1></header>
  <nav>
    <button data-section="password" class="active">üîê Password</button>
    <button data-section="ip">üåç IP</button>
    <button data-section="subnet">üìê Subnet</button>
  </nav>
  <main>
    <section id="password" class="active">
      <h2>Generatore Password</h2>
      <label>Lunghezza: <span id="valoreLunghezza">12</span></label><br>
      <input type="range" id="length" min="6" max="64" value="12"><br>
      <div style="margin-top:1rem;">
        <strong>Livelli:</strong><br>
        <button onclick="setPreset('low')">üî¥ Debole</button>
        <button onclick="setPreset('secure')">üü† Sicura</button>
        <button onclick="setPreset('high')">üü¢ Alta</button>
      </div>
      <div style="margin-top:1rem;">
        <label><input type="checkbox" id="uppercase" checked> Maiuscole</label><br>
        <label><input type="checkbox" id="numbers" checked> Numeri</label><br>
        <label><input type="checkbox" id="symbols"> Simboli</label><br>
        <label><input type="checkbox" id="noRepeat"> No ripetizione</label>
      </div>
      <input type="text" id="output" readonly style="margin-top:1rem;"><br>
      <p id="copiato">‚úÖ Copiata!</p>
    </section>
    <section id="ip">
      <h2>Il tuo IP pubblico</h2>
      <p id="ipVal">Caricamento...</p>
    </section>
    <section id="subnet">
      <h2>Calcolatore Subnet/CIDR</h2>
      <input type="text" id="subnetInput" placeholder="192.168.1.10/24"><br>
      <button onclick="calcolaSubnet()">Calcola</button>
      <div id="subnetOutput" style="margin-top:1rem;"></div>
    </section>
  </main>
  <footer><p>¬© 2025 Alessandro Garuti</p></footer>
  <script>
    function toggleTheme() {
      const body = document.body;
      body.dataset.theme = body.dataset.theme === "dark" ? "light" : "dark";
    }
    document.querySelectorAll("nav button").forEach(btn => {
      btn.addEventListener("click", () => {
        document.querySelectorAll("nav button").forEach(b => b.classList.remove("active"));
        document.querySelectorAll("main section").forEach(sec => sec.classList.remove("active"));
        btn.classList.add("active");
        document.getElementById(btn.dataset.section).classList.add("active");
      });
    });
    function setPreset(level) {
      const len = document.getElementById("length");
      const up = document.getElementById("uppercase");
      const num = document.getElementById("numbers");
      const sym = document.getElementById("symbols");
      const norep = document.getElementById("noRepeat");
      const out = document.getElementById("output");

      if (level === 'low') {
        len.value = 8; up.checked = false; num.checked = false; sym.checked = false; norep.checked = false;
        out.style.border = "3px solid red";
      } else if (level === 'secure') {
        len.value = 12; up.checked = true; num.checked = true; sym.checked = false; norep.checked = false;
        out.style.border = "3px solid orange";
      } else {
        len.value = 20; up.checked = true; num.checked = true; sym.checked = true; norep.checked = true;
        out.style.border = "3px solid green";
      }
      document.getElementById("valoreLunghezza").textContent = len.value;
      aggiornaPassword();
    }
    function generaPassword(l, opt) {
      const abc = "abcdefghijklmnopqrstuvwxyz";
      let chars = abc;
      if (opt.uppercase) chars += abc.toUpperCase();
      if (opt.numbers) chars += "0123456789";
      if (opt.symbols) chars += "!@#$%^&*()[]{}<>?";
      let out = "";
      const used = new Set();
      while (out.length < l) {
        const c = chars[Math.floor(Math.random() * chars.length)];
        if (!opt.noRepeat || !used.has(c)) {
          out += c;
          used.add(c);
        }
      }
      return out;
    }
    function aggiornaPassword() {
      const l = parseInt(document.getElementById("length").value);
      const o = {
        uppercase: document.getElementById("uppercase").checked,
        numbers: document.getElementById("numbers").checked,
        symbols: document.getElementById("symbols").checked,
        noRepeat: document.getElementById("noRepeat").checked
      };
      const p = generaPassword(l, o);
      const out = document.getElementById("output");
      out.value = p;
      out.select(); document.execCommand("copy");
      document.getElementById("copiato").style.opacity = 1;
      setTimeout(() => document.getElementById("copiato").style.opacity = 0, 2000);
    }
    ["length", "uppercase", "numbers", "symbols", "noRepeat"].forEach(id => {
      document.getElementById(id).addEventListener("input", aggiornaPassword);
    });
    aggiornaPassword();
    fetch("https://api.ipify.org?format=json")
      .then(res => res.json())
      .then(data => document.getElementById("ipVal").textContent = data.ip)
      .catch(() => document.getElementById("ipVal").textContent = "Errore");
    function calcolaSubnet() {
      const input = document.getElementById("subnetInput").value.trim();
      const match = input.match(/^(\d{1,3}(?:\.\d{1,3}){3})\/(\d{1,2})$/);
      const out = document.getElementById("subnetOutput");
      if (!match) return out.innerHTML = "<p>‚ö†Ô∏è Formato invalido</p>";
      const ip = match[1].split(".").map(Number), cidr = +match[2];
      if (ip.some(o => o < 0 || o > 255) || cidr > 32) return out.innerHTML = "<p>‚ö†Ô∏è IP/CIDR errato</p>";
      const ipNum = ip.reduce((a,b) => (a<<8)+b);
      const mask = cidr === 0 ? 0 : 0xffffffff << (32 - cidr);
      const net = ipNum & mask, bc = net | (~mask >>> 0);
      const toIP = n => [(n>>24)&255,(n>>16)&255,(n>>8)&255,n&255].join(".");
      out.innerHTML = `
        <p><strong>IP:</strong> ${toIP(ipNum)}</p>
        <p><strong>Netmask:</strong> ${toIP(mask)}</p>
        <p><strong>Rete:</strong> ${toIP(net)}</p>
        <p><strong>Broadcast:</strong> ${toIP(bc)}</p>
        ${cidr < 31 ? `<p><strong>Range host:</strong> ${toIP(net+1)} ‚Äì ${toIP(bc-1)}</p>` : ""}
      `;
    }
  </script>
</body>
</html>
